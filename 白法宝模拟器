-- Gui to Lua
-- Version: 3.2

-- Instances:

local ScreenGui = Instance.new("ScreenGui")
local Main = Instance.new("Frame")
local biaoti = Instance.new("TextLabel")
local Close = Instance.new("TextButton")
local dafujing = Instance.new("TextButton")
local dazuida = Instance.new("TextButton")
local zuixiao = Instance.new("TextButton")
local TextButton = Instance.new("TextButton")

--Properties:

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

Main.Name = "Main"
Main.Parent = ScreenGui
Main.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Main.Size = UDim2.new(0, 154, 0, 189)
Main.Active = true
Main.Draggable = true
local plr = game.Players.LocalPlayer.Character.HumanoidRootPart

function getHighest()
	local high = {}
	for i, v in pairs(game:GetService("Workspace").Fight.Chests:GetChildren()) do
		for a, b in pairs(game:GetService("Workspace").Fight.ClientChests:GetChildren()) do
			if v.Name == b.Name then
				table.insert(high,v.ChestHp.Value)
				table.sort(high, function(a,b) return a > b end)
			end
		end
	end

	for a, b in pairs(game:GetService("Workspace").Fight.Chests:GetChildren()) do
		if high[1] == b.ChestHp.Value then
			return b.Name
		end
	end    
end

function getLowest()
	local low = {}
	for i, v in pairs(game:GetService("Workspace").Fight.Chests:GetChildren()) do
		for a, b in pairs(game:GetService("Workspace").Fight.ClientChests:GetChildren()) do
			if v.Name == b.Name then
				table.insert(low,v.ChestHp.Value)
				table.sort(low, function(a,b) return a < b end)
			end
		end
	end

	for a, b in pairs(game:GetService("Workspace").Fight.Chests:GetChildren()) do
		if low[1] == b.ChestHp.Value then
			return b.Name
		end
	end    
end

function getNear()
	local near;
	local nearr = math.huge

	for i, v in pairs(game:GetService("Workspace").Fight.ClientChests:GetChildren()) do
		if (plr.Position - v.Root.Position).Magnitude < nearr then
			near = v
			nearr = (plr.Position - v.Root.Position).Magnitude
		end
	end

	return near
end
biaoti.Name = "biaoti"
biaoti.Parent = Main
biaoti.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
biaoti.Size = UDim2.new(0, 114, 0, 38)
biaoti.Font = Enum.Font.SourceSans
biaoti.Text = "白V0.9"
biaoti.TextColor3 = Color3.fromRGB(0, 0, 0)
biaoti.TextSize = 14.000

Close.Name = "Close"
Close.Parent = Main
Close.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Close.Position = UDim2.new(0.740259767, 0, 0, 0)
Close.Size = UDim2.new(0, 40, 0, 38)
Close.Font = Enum.Font.SourceSans
Close.Text = "X"
Close.TextColor3 = Color3.fromRGB(0, 0, 0)
Close.TextSize = 14.000
Close.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
end)
dafujing.Name = "dafujing"
dafujing.Parent = Main
dafujing.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
dafujing.Position = UDim2.new(0, 0, 0.201058194, 0)
dafujing.Size = UDim2.new(0, 154, 0, 38)
dafujing.Font = Enum.Font.SourceSans
dafujing.Text = "打附近的桩（关）"
dafujing.TextColor3 = Color3.fromRGB(0, 0, 0)
dafujing.TextSize = 14.000
dafujing.MouseButton1Click:Connect(function()
	if dafujing.Text== "打附近的桩（关）" then
		dafujing.Text = "打附近的桩（开）"
		else dafujing.Text = "打附近的桩（关）"
	end
	while dafujing.Text == "打附近的桩（开）" do
		pcall(function()
			local nearest = getNear()

			plr.CFrame = nearest.Root.CFrame * CFrame.new(0,0,10)
			wait(1)

			workspace.Fight.Events.FightAttack:InvokeServer(0,nearest.Name)   

			repeat task.wait()
				plr.CFrame = nearest.Root.CFrame * CFrame.new(0,0,10)
			until nearest.Root == nil 
		end)
	end
end)
dazuida.Name = "dazuida"
dazuida.Parent = Main
dazuida.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
dazuida.Position = UDim2.new(0, 0, 0.402116388, 0)
dazuida.Size = UDim2.new(0, 154, 0, 35)
dazuida.Font = Enum.Font.SourceSans
dazuida.Text = "打最大的桩（关）"
dazuida.TextColor3 = Color3.fromRGB(0, 0, 0)
dazuida.TextSize = 14.000	
dazuida.MouseButton1Click:Connect(function()
	if dazuida.Text== "打最大的桩（关）" then
		dazuida.Text = "打最大的桩（开）"
	else dazuida.Text = "打最大的桩（关）"
end
	while dazuida.Text== "打最大的桩（开）" do
		pcall(function()
			local highest = getHighest()

			plr.CFrame = game:GetService("Workspace").Fight.ClientChests[highest].Root.CFrame * CFrame.new(0,0,10)
			wait(.5)

			workspace.Fight.Events.FightAttack:InvokeServer(0,highest)

			repeat task.wait()
				plr.CFrame = game:GetService("Workspace").Fight.ClientChests[highest].Root.CFrame * CFrame.new(0,0,10)
			until not game:GetService("Workspace").Fight.ClientChests[highest] 
		end)
end
end)
zuixiao.Name = "zuixiao"
zuixiao.Parent = Main
zuixiao.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
zuixiao.Position = UDim2.new(0, 0, 0.587301612, 0)
zuixiao.Size = UDim2.new(0, 154, 0, 40)
zuixiao.Font = Enum.Font.SourceSans
zuixiao.Text = "打最小的桩（关）"
zuixiao.TextColor3 = Color3.fromRGB(0, 0, 0)
zuixiao.TextSize = 14.000
zuixiao.MouseButton1Click:Connect(function()
	if zuixiao.Text== "打最小的桩（关）" then
		zuixiao.Text = "打最小的桩（开）"
	else zuixiao.Text = "打最小的桩（关）"
end
	while zuixiao.Text== "打最小的桩（开）" do
	pcall(function()
		local lowest = getLowest()

		plr.CFrame = game:GetService("Workspace").Fight.ClientChests[lowest].Root.CFrame * CFrame.new(0,0,10)
		wait(.5)

		workspace.Fight.Events.FightAttack:InvokeServer(0,lowest)

		repeat task.wait()
			plr.CFrame = game:GetService("Workspace").Fight.ClientChests[lowest].Root.CFrame * CFrame.new(0,0,10)
		until not game:GetService("Workspace").Fight.ClientChests[lowest] 
	end)

end
end)

TextButton.Parent = Main
TextButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextButton.Position = UDim2.new(0, 0, 0.798941791, 0)
TextButton.Size = UDim2.new(0, 154, 0, 38)
TextButton.Font = Enum.Font.SourceSans
TextButton.Text = "自动收集（关）"
TextButton.TextColor3 = Color3.fromRGB(0, 0, 0)
TextButton.TextSize = 14.000

TextButton.MouseButton1Click:Connect(function()
	if TextButton.Text== "自动收集（关）" then
		TextButton.Text = "自动收集（开）"
	else TextButton.Text = "自动收集（关）"
	end
	while TextButton.Text== "自动收集（开）" do
	    
	    wait()
		for i, v in pairs(game:GetService("Workspace").Rewards:GetChildren()) do
			if v ~= nil then
				v.CFrame = plr.CFrame
			end
		end
	
		
	end
	end)
